
============================================================
Started: 20251216_023156
============================================================

============================================================
PHASE 1: Data Loading & Activation Extraction
============================================================

Loading datasets...
Loading TOFU dataset (subset: forget10)...
Loaded 100 TOFU queries
Loaded 100 total queries

--- Extracting from BASE model ---
Extracting activations from layers [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
Loading model: locuslab/tofu_ft_phi-1.5
Saved base activations to outputs_tofu_1_grad_diff/base_activations.pkl

--- Extracting from UNLEARNED model ---
Extracting activations from layers [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
Loading model: locuslab/phi_grad_diff_1e-05_forget10
Saved unlearned activations to outputs_tofu_1_grad_diff/unlearned_activations.pkl

============================================================
PHASE 2: Geometric Feature Computation
============================================================

--- Computing features for BASE model ---
Saved base features to outputs_tofu_1_grad_diff/base_geometric_features.csv

--- Computing features for UNLEARNED model ---
Saved unlearned features to outputs_tofu_1_grad_diff/unlearned_geometric_features.csv

Base Feature Statistics:
       local_density_mean  ...  cross_layer_consistency_min
count          100.000000  ...                   100.000000
mean             1.672874  ...                     0.603516
std              0.247223  ...                     0.018692
min              1.175277  ...                     0.560059
25%              1.523315  ...                     0.589355
50%              1.665396  ...                     0.601807
75%              1.822060  ...                     0.617310
max              2.312076  ...                     0.649902

[8 rows x 24 columns]

============================================================
PHASE 3: Vulnerability Testing
============================================================

--- Part A: Base Model Accuracy (sampling baseline) ---
Saved base model accuracy to outputs_tofu_1_grad_diff/base_accuracy.csv
Base model CAF: 0.747

--- Unloading base model to free GPU memory ---
GPU memory freed. Available: 18.97 GB

--- Part B: Unlearned Model Retention (sampling, no steering) ---
Saved unlearned retention results to outputs_tofu_1_grad_diff/direct_retention.csv
Unlearned model retention CAF: 0.115

--- Comparison ---
Base model CAF:             0.747
Unlearned model retention:  0.115
Unlearning effectiveness:   0.885

--- Part C: Attack Method = 'all' ---

--- Activation Steering Attack ---
Layer search enabled: testing layers [12, 13]

============================================================
Testing Layer 12
============================================================
Running LOCAL extraction attack (per-question steering)...

--- Anonymization Check (Layer 12) ---
Original: What is the full name of the author born in Taipei, Taiwan on 05/11/1991 who writes in the genre of leadership?
  Anon0: What is the full name of the author born in Newcity, Newland on 01/01/2000 who writes in the genre of fiction?
  Anon1: What is the full name of the author born in Oldtown, Oldland on 06/15/1995 who writes in the genre of non-fiction?
  Anon2: What is the full name of the author born in Midville, Midland on 03/20/1998 who writes in the genre of mystery?
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 25.5469
  Vector mean: -0.0023
  Vector std: 0.5649
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.7969
  Vector mean: -0.0006
  Vector std: 0.3711
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.4531
  Vector mean: -0.0025
  Vector std: 0.3857
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.5625
  Vector mean: 0.0011
  Vector std: 0.3879
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.0625
  Vector mean: 0.0005
  Vector std: 0.2445
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.9062
  Vector mean: 0.0024
  Vector std: 0.3293
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.5156
  Vector mean: 0.0030
  Vector std: 0.3650
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.0469
  Vector mean: -0.0009
  Vector std: 0.3547
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.9922
  Vector mean: 0.0003
  Vector std: 0.3093
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.3047
  Vector mean: 0.0011
  Vector std: 0.2939
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.5156
  Vector mean: 0.0027
  Vector std: 0.2766
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.5703
  Vector mean: -0.0030
  Vector std: 0.3220
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.0469
  Vector mean: 0.0006
  Vector std: 0.3105
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 20.5781
  Vector mean: -0.0013
  Vector std: 0.4546
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.8281
  Vector mean: -0.0004
  Vector std: 0.3276
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.7031
  Vector mean: 0.0026
  Vector std: 0.2808
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.1641
  Vector mean: 0.0001
  Vector std: 0.3130
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.3672
  Vector mean: -0.0008
  Vector std: 0.3176
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.7812
  Vector mean: 0.0005
  Vector std: 0.2603
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.9141
  Vector mean: -0.0009
  Vector std: 0.2854
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.4375
  Vector mean: -0.0003
  Vector std: 0.3633
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.9375
  Vector mean: 0.0005
  Vector std: 0.4849
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.8281
  Vector mean: 0.0024
  Vector std: 0.3718
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 31.4375
  Vector mean: 0.0057
  Vector std: 0.6948
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 28.2812
  Vector mean: 0.0019
  Vector std: 0.6250
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 31.8750
  Vector mean: 0.0021
  Vector std: 0.7046
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 30.4062
  Vector mean: 0.0019
  Vector std: 0.6724
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 30.2500
  Vector mean: 0.0043
  Vector std: 0.6685
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.1172
  Vector mean: -0.0007
  Vector std: 0.3342
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.1797
  Vector mean: 0.0010
  Vector std: 0.3132
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 26.1562
  Vector mean: -0.0034
  Vector std: 0.5781
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.9297
  Vector mean: -0.0009
  Vector std: 0.2859
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 32.4375
  Vector mean: -0.0069
  Vector std: 0.7168
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 35.3125
  Vector mean: 0.0056
  Vector std: 0.7808
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.7031
  Vector mean: 0.0003
  Vector std: 0.4797
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 27.5156
  Vector mean: -0.0069
  Vector std: 0.6079
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 29.5000
  Vector mean: 0.0043
  Vector std: 0.6523
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.0625
  Vector mean: -0.0041
  Vector std: 0.3992
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 29.8750
  Vector mean: 0.0033
  Vector std: 0.6602
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 20.2188
  Vector mean: -0.0002
  Vector std: 0.4468
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.1172
  Vector mean: 0.0014
  Vector std: 0.3342
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 37.1875
  Vector mean: 0.0056
  Vector std: 0.8218
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.7266
  Vector mean: 0.0011
  Vector std: 0.3032
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.0312
  Vector mean: 0.0021
  Vector std: 0.4868
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 27.3750
  Vector mean: 0.0046
  Vector std: 0.6050
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.2500
  Vector mean: -0.0006
  Vector std: 0.5137
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 19.0781
  Vector mean: 0.0035
  Vector std: 0.4216
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 27.0000
  Vector mean: 0.0037
  Vector std: 0.5967
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 29.5938
  Vector mean: 0.0070
  Vector std: 0.6543
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.7500
  Vector mean: 0.0003
  Vector std: 0.2375
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 5.9023
  Vector mean: -0.0040
  Vector std: 0.1304
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 29.6562
  Vector mean: 0.0053
  Vector std: 0.6558
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 34.4062
  Vector mean: 0.0023
  Vector std: 0.7603
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 25.0469
  Vector mean: 0.0032
  Vector std: 0.5537
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.7656
  Vector mean: 0.0064
  Vector std: 0.5474
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.4062
  Vector mean: 0.0014
  Vector std: 0.4731
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.0391
  Vector mean: 0.0003
  Vector std: 0.2219
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 26.1875
  Vector mean: 0.0070
  Vector std: 0.5791
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.0547
  Vector mean: 0.0011
  Vector std: 0.2223
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 36.1562
  Vector mean: 0.0055
  Vector std: 0.7993
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 0.0000
  Vector mean: 0.0000
  Vector std: 0.0000
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.3594
  Vector mean: -0.0001
  Vector std: 0.4058
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 30.1406
  Vector mean: 0.0008
  Vector std: 0.6660
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.2344
  Vector mean: 0.0045
  Vector std: 0.5356
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.2891
  Vector mean: 0.0027
  Vector std: 0.3379
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.0625
  Vector mean: 0.0027
  Vector std: 0.3552
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 36.7188
  Vector mean: 0.0066
  Vector std: 0.8110
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.2344
  Vector mean: 0.0020
  Vector std: 0.4692
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.6250
  Vector mean: 0.0030
  Vector std: 0.5444
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.2031
  Vector mean: -0.0022
  Vector std: 0.3362
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 3.8398
  Vector mean: -0.0016
  Vector std: 0.0849
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 0.0000
  Vector mean: 0.0000
  Vector std: 0.0000
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.1094
  Vector mean: -0.0015
  Vector std: 0.3118
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.8203
  Vector mean: -0.0027
  Vector std: 0.2391
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.2734
  Vector mean: 0.0021
  Vector std: 0.2712
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.8984
  Vector mean: -0.0005
  Vector std: 0.2629
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 27.9375
  Vector mean: 0.0016
  Vector std: 0.6177
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.6094
  Vector mean: -0.0008
  Vector std: 0.5439
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.5156
  Vector mean: -0.0024
  Vector std: 0.2988
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.7656
  Vector mean: -0.0020
  Vector std: 0.5254
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.7422
  Vector mean: 0.0000
  Vector std: 0.3259
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.0156
  Vector mean: 0.0025
  Vector std: 0.4646
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.5312
  Vector mean: 0.0005
  Vector std: 0.5200
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.5156
  Vector mean: -0.0022
  Vector std: 0.4976
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.5781
  Vector mean: -0.0021
  Vector std: 0.4106
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.8125
  Vector mean: 0.0003
  Vector std: 0.3713
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.5000
  Vector mean: -0.0013
  Vector std: 0.5415
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 28.8594
  Vector mean: 0.0001
  Vector std: 0.6382
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.1406
  Vector mean: -0.0006
  Vector std: 0.3789
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 20.6406
  Vector mean: 0.0017
  Vector std: 0.4561
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.2969
  Vector mean: 0.0022
  Vector std: 0.5151
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 40.6562
  Vector mean: 0.0033
  Vector std: 0.8989
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 39.4062
  Vector mean: 0.0010
  Vector std: 0.8706
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 29.7031
  Vector mean: -0.0004
  Vector std: 0.6562
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.2969
  Vector mean: 0.0014
  Vector std: 0.3823
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.8125
  Vector mean: -0.0007
  Vector std: 0.4819
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.9844
  Vector mean: -0.0011
  Vector std: 0.5522
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 19.5625
  Vector mean: 0.0049
  Vector std: 0.4324
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.4375
  Vector mean: 0.0019
  Vector std: 0.3635
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.6953
  Vector mean: 0.0026
  Vector std: 0.3469

Layer 12 Results:
  Success Rate: 47.00%
  Average CAF: 0.110
Saved to outputs_tofu_1_grad_diff/activation_steering_layer12.csv

============================================================
Testing Layer 13
============================================================
Running LOCAL extraction attack (per-question steering)...

--- Anonymization Check (Layer 13) ---
Original: What is the full name of the author born in Taipei, Taiwan on 05/11/1991 who writes in the genre of leadership?
  Anon0: What is the full name of the author born in Newcity, Newland on 01/01/2000 who writes in the genre of fiction?
  Anon1: What is the full name of the author born in Oldtown, Oldland on 06/15/1995 who writes in the genre of non-fiction?
  Anon2: What is the full name of the author born in Midville, Midland on 03/20/1998 who writes in the genre of mystery?
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 25.4844
  Vector mean: -0.0015
  Vector std: 0.5635
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.2188
  Vector mean: -0.0020
  Vector std: 0.4026
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.3750
  Vector mean: -0.0025
  Vector std: 0.4060
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 20.0312
  Vector mean: 0.0028
  Vector std: 0.4426
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.4453
  Vector mean: 0.0012
  Vector std: 0.2751
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.0938
  Vector mean: 0.0022
  Vector std: 0.3999
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.7031
  Vector mean: 0.0037
  Vector std: 0.3914
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 20.0625
  Vector mean: -0.0011
  Vector std: 0.4434
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.3438
  Vector mean: 0.0010
  Vector std: 0.3391
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.3906
  Vector mean: 0.0010
  Vector std: 0.3181
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.0078
  Vector mean: 0.0023
  Vector std: 0.3096
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.1094
  Vector mean: -0.0024
  Vector std: 0.3562
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.3672
  Vector mean: -0.0002
  Vector std: 0.3396
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.9844
  Vector mean: -0.0007
  Vector std: 0.4858
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.9375
  Vector mean: 0.0002
  Vector std: 0.3523
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.4609
  Vector mean: 0.0032
  Vector std: 0.3196
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.1094
  Vector mean: 0.0003
  Vector std: 0.3782
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.4531
  Vector mean: -0.0009
  Vector std: 0.3416
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.9531
  Vector mean: 0.0003
  Vector std: 0.2864
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.8125
  Vector mean: -0.0011
  Vector std: 0.3052
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.8438
  Vector mean: 0.0003
  Vector std: 0.3943
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 25.8438
  Vector mean: -0.0013
  Vector std: 0.5713
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.9219
  Vector mean: 0.0017
  Vector std: 0.4182
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 34.7500
  Vector mean: 0.0061
  Vector std: 0.7681
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 29.7500
  Vector mean: 0.0028
  Vector std: 0.6572
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 34.7812
  Vector mean: 0.0019
  Vector std: 0.7686
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 32.8438
  Vector mean: 0.0004
  Vector std: 0.7261
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 32.7188
  Vector mean: 0.0043
  Vector std: 0.7231
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.6406
  Vector mean: -0.0015
  Vector std: 0.3679
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.1641
  Vector mean: 0.0021
  Vector std: 0.3350
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 26.6250
  Vector mean: -0.0032
  Vector std: 0.5884
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.7422
  Vector mean: -0.0015
  Vector std: 0.3037
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 36.2812
  Vector mean: -0.0079
  Vector std: 0.8018
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 37.1562
  Vector mean: 0.0037
  Vector std: 0.8213
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.4531
  Vector mean: -0.0009
  Vector std: 0.5405
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 30.2969
  Vector mean: -0.0077
  Vector std: 0.6694
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 31.9531
  Vector mean: 0.0041
  Vector std: 0.7061
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 20.7344
  Vector mean: -0.0052
  Vector std: 0.4583
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 33.8750
  Vector mean: 0.0053
  Vector std: 0.7485
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.3594
  Vector mean: -0.0012
  Vector std: 0.5161
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.5000
  Vector mean: 0.0022
  Vector std: 0.3647
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 39.4062
  Vector mean: 0.0035
  Vector std: 0.8706
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.3438
  Vector mean: 0.0015
  Vector std: 0.3391
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.5625
  Vector mean: 0.0027
  Vector std: 0.5430
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 30.6562
  Vector mean: 0.0044
  Vector std: 0.6777
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 25.4062
  Vector mean: -0.0017
  Vector std: 0.5615
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 20.1562
  Vector mean: 0.0030
  Vector std: 0.4456
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 30.1875
  Vector mean: 0.0044
  Vector std: 0.6670
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 32.9375
  Vector mean: 0.0055
  Vector std: 0.7280
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.9922
  Vector mean: 0.0005
  Vector std: 0.2651
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 5.9219
  Vector mean: -0.0038
  Vector std: 0.1309
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 31.7969
  Vector mean: 0.0044
  Vector std: 0.7026
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 37.4062
  Vector mean: 0.0001
  Vector std: 0.8267
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 28.7969
  Vector mean: 0.0016
  Vector std: 0.6362
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 27.8750
  Vector mean: 0.0062
  Vector std: 0.6162
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.2500
  Vector mean: 0.0014
  Vector std: 0.4919
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.5078
  Vector mean: 0.0000
  Vector std: 0.2544
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 29.8906
  Vector mean: 0.0072
  Vector std: 0.6606
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.1328
  Vector mean: 0.0014
  Vector std: 0.2461
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 38.6875
  Vector mean: 0.0062
  Vector std: 0.8550
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 0.0000
  Vector mean: 0.0000
  Vector std: 0.0000
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.9219
  Vector mean: -0.0002
  Vector std: 0.4180
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 33.9688
  Vector mean: 0.0010
  Vector std: 0.7505
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 27.6562
  Vector mean: 0.0046
  Vector std: 0.6113
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.1094
  Vector mean: 0.0033
  Vector std: 0.3782
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.2812
  Vector mean: 0.0030
  Vector std: 0.3818
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 39.7500
  Vector mean: 0.0073
  Vector std: 0.8789
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.9219
  Vector mean: 0.0011
  Vector std: 0.5063
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 27.1562
  Vector mean: 0.0019
  Vector std: 0.6001
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.1719
  Vector mean: -0.0012
  Vector std: 0.3577
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 3.9609
  Vector mean: -0.0018
  Vector std: 0.0875
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 0.0000
  Vector mean: 0.0000
  Vector std: 0.0000
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.3125
  Vector mean: -0.0010
  Vector std: 0.3384
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.4609
  Vector mean: -0.0033
  Vector std: 0.2534
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.6719
  Vector mean: 0.0026
  Vector std: 0.3022
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.5156
  Vector mean: 0.0004
  Vector std: 0.2766
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 31.2969
  Vector mean: 0.0009
  Vector std: 0.6919
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 28.0625
  Vector mean: -0.0028
  Vector std: 0.6201
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.4531
  Vector mean: -0.0022
  Vector std: 0.3193
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.6562
  Vector mean: -0.0034
  Vector std: 0.5449
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.2031
  Vector mean: 0.0002
  Vector std: 0.3359
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.8438
  Vector mean: 0.0038
  Vector std: 0.5049
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.2812
  Vector mean: 0.0006
  Vector std: 0.5366
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.5312
  Vector mean: -0.0027
  Vector std: 0.5200
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 19.4062
  Vector mean: -0.0021
  Vector std: 0.4290
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.8594
  Vector mean: -0.0000
  Vector std: 0.4170
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 26.1250
  Vector mean: -0.0007
  Vector std: 0.5776
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 30.3594
  Vector mean: 0.0023
  Vector std: 0.6709
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.8750
  Vector mean: -0.0012
  Vector std: 0.4170
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.1875
  Vector mean: 0.0006
  Vector std: 0.5127
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 25.0781
  Vector mean: 0.0003
  Vector std: 0.5542
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 43.2812
  Vector mean: 0.0043
  Vector std: 0.9565
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 41.1875
  Vector mean: 0.0021
  Vector std: 0.9106
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 33.6562
  Vector mean: -0.0007
  Vector std: 0.7441
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 19.2344
  Vector mean: 0.0012
  Vector std: 0.4250
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.1250
  Vector mean: -0.0012
  Vector std: 0.5112
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 26.2812
  Vector mean: -0.0028
  Vector std: 0.5811
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.1719
  Vector mean: 0.0044
  Vector std: 0.4680
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.4375
  Vector mean: 0.0011
  Vector std: 0.3853
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.9062
  Vector mean: 0.0021
  Vector std: 0.3735

Layer 13 Results:
  Success Rate: 40.00%
  Average CAF: 0.109
Saved to outputs_tofu_1_grad_diff/activation_steering_layer13.csv

============================================================
LAYER COMPARISON
============================================================
Layer      Success Rate    Average CAF    
------------------------------------------------------------
12         47.00%          0.110           ‚Üê BEST
13         40.00%          0.109          

Saved best layer results to outputs_tofu_1_grad_diff/activation_steering_results.csv

--- Embedding Space Attack ---
