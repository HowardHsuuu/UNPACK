
============================================================
Started: 20251216_023251
============================================================

============================================================
PHASE 1: Data Loading & Activation Extraction
============================================================

Loading datasets...
Loading TOFU dataset (subset: forget10)...
Loaded 100 TOFU queries
Loaded 100 total queries

--- Extracting from BASE model ---
Extracting activations from layers [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
Loading model: locuslab/tofu_ft_phi-1.5
Saved base activations to outputs_tofu_3_KL/base_activations.pkl

--- Extracting from UNLEARNED model ---
Extracting activations from layers [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]
Loading model: locuslab/phi_KL_1e-05_forget10
Saved unlearned activations to outputs_tofu_3_KL/unlearned_activations.pkl

============================================================
PHASE 2: Geometric Feature Computation
============================================================

--- Computing features for BASE model ---
Saved base features to outputs_tofu_3_KL/base_geometric_features.csv

--- Computing features for UNLEARNED model ---
Saved unlearned features to outputs_tofu_3_KL/unlearned_geometric_features.csv

Base Feature Statistics:
       local_density_mean  ...  cross_layer_consistency_min
count          100.000000  ...                   100.000000
mean             1.673483  ...                     0.603516
std              0.248026  ...                     0.018692
min              1.176712  ...                     0.560059
25%              1.524988  ...                     0.589355
50%              1.666372  ...                     0.601807
75%              1.825180  ...                     0.617310
max              2.308151  ...                     0.649902

[8 rows x 24 columns]

============================================================
PHASE 3: Vulnerability Testing
============================================================

--- Part A: Base Model Accuracy (sampling baseline) ---
Saved base model accuracy to outputs_tofu_3_KL/base_accuracy.csv
Base model CAF: 0.739

--- Unloading base model to free GPU memory ---
GPU memory freed. Available: 19.16 GB

--- Part B: Unlearned Model Retention (sampling, no steering) ---
Saved unlearned retention results to outputs_tofu_3_KL/direct_retention.csv
Unlearned model retention CAF: 0.009

--- Comparison ---
Base model CAF:             0.739
Unlearned model retention:  0.009
Unlearning effectiveness:   0.991

--- Part C: Attack Method = 'all' ---

--- Activation Steering Attack ---
Layer search enabled: testing layers [12, 13]

============================================================
Testing Layer 12
============================================================
Running LOCAL extraction attack (per-question steering)...

--- Anonymization Check (Layer 12) ---
Original: What is the full name of the author born in Taipei, Taiwan on 05/11/1991 who writes in the genre of leadership?
  Anon0: What is the full name of the author born in Newcity, Newland on 01/01/2000 who writes in the genre of fiction?
  Anon1: What is the full name of the author born in Oldtown, Oldland on 06/15/1995 who writes in the genre of non-fiction?
  Anon2: What is the full name of the author born in Midville, Midland on 03/20/1998 who writes in the genre of mystery?
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.5703
  Vector mean: -0.0012
  Vector std: 0.2115
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.4297
  Vector mean: 0.0000
  Vector std: 0.1642
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.8125
  Vector mean: -0.0004
  Vector std: 0.1948
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.7109
  Vector mean: 0.0000
  Vector std: 0.1926
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 5.6211
  Vector mean: 0.0004
  Vector std: 0.1242
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.5117
  Vector mean: 0.0014
  Vector std: 0.1439
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.5508
  Vector mean: -0.0016
  Vector std: 0.1669
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.0312
  Vector mean: 0.0023
  Vector std: 0.1775
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.7617
  Vector mean: -0.0001
  Vector std: 0.1494
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.0703
  Vector mean: -0.0011
  Vector std: 0.1562
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.3359
  Vector mean: 0.0002
  Vector std: 0.1621
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.3203
  Vector mean: -0.0033
  Vector std: 0.1840
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.0547
  Vector mean: -0.0015
  Vector std: 0.1780
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.2344
  Vector mean: -0.0022
  Vector std: 0.2041
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.4492
  Vector mean: -0.0006
  Vector std: 0.1647
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.3984
  Vector mean: -0.0007
  Vector std: 0.1415
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.7266
  Vector mean: -0.0007
  Vector std: 0.1487
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.7070
  Vector mean: 0.0001
  Vector std: 0.1703
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.0508
  Vector mean: -0.0002
  Vector std: 0.1559
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.5703
  Vector mean: -0.0002
  Vector std: 0.1451
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.1641
  Vector mean: -0.0003
  Vector std: 0.2247
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.3594
  Vector mean: -0.0022
  Vector std: 0.3174
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.1562
  Vector mean: 0.0001
  Vector std: 0.2024
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.5938
  Vector mean: 0.0005
  Vector std: 0.3889
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.7578
  Vector mean: -0.0058
  Vector std: 0.3484
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.2656
  Vector mean: -0.0017
  Vector std: 0.3816
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.7266
  Vector mean: -0.0021
  Vector std: 0.3254
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.3125
  Vector mean: -0.0002
  Vector std: 0.3164
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.1016
  Vector mean: -0.0015
  Vector std: 0.1791
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.0078
  Vector mean: 0.0000
  Vector std: 0.1769
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.6172
  Vector mean: -0.0030
  Vector std: 0.2568
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.4648
  Vector mean: -0.0007
  Vector std: 0.1650
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.5000
  Vector mean: -0.0046
  Vector std: 0.3647
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.0312
  Vector mean: -0.0023
  Vector std: 0.3545
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.3281
  Vector mean: -0.0001
  Vector std: 0.2944
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.0859
  Vector mean: -0.0045
  Vector std: 0.3113
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.2031
  Vector mean: -0.0022
  Vector std: 0.3362
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.4297
  Vector mean: -0.0013
  Vector std: 0.2969
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.3906
  Vector mean: -0.0012
  Vector std: 0.3843
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.0547
  Vector mean: -0.0017
  Vector std: 0.3328
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.1094
  Vector mean: 0.0009
  Vector std: 0.2013
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 23.3125
  Vector mean: 0.0003
  Vector std: 0.5151
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.0469
  Vector mean: 0.0003
  Vector std: 0.1780
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.3125
  Vector mean: 0.0020
  Vector std: 0.3164
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.4062
  Vector mean: 0.0020
  Vector std: 0.3625
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.4688
  Vector mean: 0.0003
  Vector std: 0.4082
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.7656
  Vector mean: 0.0023
  Vector std: 0.2822
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.4453
  Vector mean: -0.0011
  Vector std: 0.3191
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.8281
  Vector mean: 0.0011
  Vector std: 0.4824
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.0273
  Vector mean: -0.0005
  Vector std: 0.1553
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 5.4219
  Vector mean: -0.0031
  Vector std: 0.1198
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.0000
  Vector mean: 0.0039
  Vector std: 0.3977
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 25.0156
  Vector mean: 0.0008
  Vector std: 0.5527
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.0938
  Vector mean: 0.0003
  Vector std: 0.3779
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.6719
  Vector mean: 0.0023
  Vector std: 0.3684
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.3906
  Vector mean: -0.0016
  Vector std: 0.2075
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.8711
  Vector mean: 0.0002
  Vector std: 0.1740
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.7891
  Vector mean: 0.0010
  Vector std: 0.3489
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.1406
  Vector mean: -0.0005
  Vector std: 0.1578
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.8438
  Vector mean: 0.0001
  Vector std: 0.5049
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 0.0000
  Vector mean: 0.0000
  Vector std: 0.0000
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.7422
  Vector mean: 0.0002
  Vector std: 0.2373
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.7969
  Vector mean: 0.0027
  Vector std: 0.4155
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.7031
  Vector mean: 0.0019
  Vector std: 0.3250
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.0938
  Vector mean: 0.0005
  Vector std: 0.1788
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.1562
  Vector mean: 0.0006
  Vector std: 0.2024
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.6719
  Vector mean: -0.0031
  Vector std: 0.4788
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.7188
  Vector mean: 0.0004
  Vector std: 0.2590
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.3906
  Vector mean: 0.0002
  Vector std: 0.3623
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.4688
  Vector mean: 0.0005
  Vector std: 0.2094
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 3.8223
  Vector mean: -0.0011
  Vector std: 0.0845
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 0.0000
  Vector mean: 0.0000
  Vector std: 0.0000
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.6562
  Vector mean: -0.0005
  Vector std: 0.1913
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.1719
  Vector mean: -0.0030
  Vector std: 0.1807
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.6016
  Vector mean: 0.0004
  Vector std: 0.1459
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.4531
  Vector mean: 0.0012
  Vector std: 0.2090
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.3750
  Vector mean: -0.0005
  Vector std: 0.4060
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.2656
  Vector mean: -0.0002
  Vector std: 0.3596
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.3047
  Vector mean: -0.0019
  Vector std: 0.1836
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.5469
  Vector mean: -0.0008
  Vector std: 0.3657
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.9297
  Vector mean: -0.0012
  Vector std: 0.2194
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.4062
  Vector mean: -0.0004
  Vector std: 0.2300
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.2578
  Vector mean: -0.0024
  Vector std: 0.2489
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.9922
  Vector mean: -0.0030
  Vector std: 0.2871
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.1094
  Vector mean: -0.0003
  Vector std: 0.2014
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.2812
  Vector mean: -0.0015
  Vector std: 0.2051
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.3906
  Vector mean: -0.0031
  Vector std: 0.2296
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.2109
  Vector mean: -0.0022
  Vector std: 0.3362
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.7109
  Vector mean: 0.0001
  Vector std: 0.1925
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.9219
  Vector mean: 0.0016
  Vector std: 0.2634
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.2188
  Vector mean: -0.0009
  Vector std: 0.2479
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 19.3281
  Vector mean: 0.0021
  Vector std: 0.4272
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.0938
  Vector mean: -0.0004
  Vector std: 0.4883
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.0547
  Vector mean: -0.0024
  Vector std: 0.2886
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.9297
  Vector mean: -0.0013
  Vector std: 0.1973
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.1953
  Vector mean: -0.0037
  Vector std: 0.2253
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.7734
  Vector mean: -0.0011
  Vector std: 0.2603
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.2656
  Vector mean: 0.0010
  Vector std: 0.2047
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.5469
  Vector mean: -0.0021
  Vector std: 0.2109
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.8750
  Vector mean: 0.0003
  Vector std: 0.1741

Layer 12 Results:
  Success Rate: 1.00%
  Average CAF: 0.008
Saved to outputs_tofu_3_KL/activation_steering_layer12.csv

============================================================
Testing Layer 13
============================================================
Running LOCAL extraction attack (per-question steering)...

--- Anonymization Check (Layer 13) ---
Original: What is the full name of the author born in Taipei, Taiwan on 05/11/1991 who writes in the genre of leadership?
  Anon0: What is the full name of the author born in Newcity, Newland on 01/01/2000 who writes in the genre of fiction?
  Anon1: What is the full name of the author born in Oldtown, Oldland on 06/15/1995 who writes in the genre of non-fiction?
  Anon2: What is the full name of the author born in Midville, Midland on 03/20/1998 who writes in the genre of mystery?
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.1875
  Vector mean: -0.0010
  Vector std: 0.2031
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.2070
  Vector mean: 0.0003
  Vector std: 0.1593
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.6250
  Vector mean: -0.0000
  Vector std: 0.1907
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.4922
  Vector mean: 0.0004
  Vector std: 0.1877
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 5.4375
  Vector mean: 0.0005
  Vector std: 0.1202
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.3984
  Vector mean: 0.0015
  Vector std: 0.1415
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.3906
  Vector mean: -0.0016
  Vector std: 0.1633
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.0234
  Vector mean: 0.0025
  Vector std: 0.1774
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.5742
  Vector mean: 0.0001
  Vector std: 0.1454
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.8711
  Vector mean: -0.0007
  Vector std: 0.1519
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.1523
  Vector mean: 0.0005
  Vector std: 0.1581
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.0234
  Vector mean: -0.0032
  Vector std: 0.1774
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.6875
  Vector mean: -0.0011
  Vector std: 0.1699
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.4453
  Vector mean: -0.0021
  Vector std: 0.2087
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.3555
  Vector mean: -0.0005
  Vector std: 0.1626
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.1484
  Vector mean: -0.0005
  Vector std: 0.1359
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.5820
  Vector mean: -0.0004
  Vector std: 0.1455
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.4570
  Vector mean: 0.0004
  Vector std: 0.1648
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.7773
  Vector mean: -0.0001
  Vector std: 0.1498
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.4961
  Vector mean: 0.0001
  Vector std: 0.1436
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.8203
  Vector mean: -0.0006
  Vector std: 0.2170
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.8906
  Vector mean: -0.0027
  Vector std: 0.3069
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.9062
  Vector mean: -0.0004
  Vector std: 0.1969
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.0938
  Vector mean: -0.0006
  Vector std: 0.3777
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.4531
  Vector mean: -0.0065
  Vector std: 0.3413
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.8594
  Vector mean: -0.0018
  Vector std: 0.3728
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.1719
  Vector mean: -0.0024
  Vector std: 0.3132
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.1094
  Vector mean: -0.0004
  Vector std: 0.3118
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.9141
  Vector mean: -0.0017
  Vector std: 0.1749
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.7812
  Vector mean: -0.0003
  Vector std: 0.1720
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.1016
  Vector mean: -0.0031
  Vector std: 0.2454
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.2812
  Vector mean: -0.0010
  Vector std: 0.1609
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.8984
  Vector mean: -0.0049
  Vector std: 0.3513
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.9531
  Vector mean: -0.0027
  Vector std: 0.3525
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.9453
  Vector mean: -0.0003
  Vector std: 0.2861
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.9375
  Vector mean: -0.0049
  Vector std: 0.3079
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.0469
  Vector mean: -0.0029
  Vector std: 0.3325
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.2734
  Vector mean: -0.0010
  Vector std: 0.2935
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.1094
  Vector mean: -0.0014
  Vector std: 0.3779
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.7266
  Vector mean: -0.0020
  Vector std: 0.3254
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.8516
  Vector mean: 0.0013
  Vector std: 0.1956
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.7500
  Vector mean: 0.0007
  Vector std: 0.5024
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.7852
  Vector mean: 0.0003
  Vector std: 0.1721
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 13.7891
  Vector mean: 0.0019
  Vector std: 0.3047
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.8984
  Vector mean: 0.0020
  Vector std: 0.3513
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.2344
  Vector mean: 0.0003
  Vector std: 0.4031
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.9219
  Vector mean: 0.0025
  Vector std: 0.2856
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.1562
  Vector mean: -0.0015
  Vector std: 0.3130
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.7969
  Vector mean: 0.0016
  Vector std: 0.4817
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.8984
  Vector mean: -0.0003
  Vector std: 0.1525
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 5.4609
  Vector mean: -0.0031
  Vector std: 0.1207
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 17.6406
  Vector mean: 0.0044
  Vector std: 0.3899
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 24.7812
  Vector mean: 0.0009
  Vector std: 0.5479
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.8750
  Vector mean: -0.0003
  Vector std: 0.3728
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.3125
  Vector mean: 0.0021
  Vector std: 0.3606
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.2344
  Vector mean: -0.0019
  Vector std: 0.2041
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.9297
  Vector mean: 0.0002
  Vector std: 0.1753
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.5625
  Vector mean: 0.0010
  Vector std: 0.3440
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.0938
  Vector mean: -0.0004
  Vector std: 0.1569
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 22.5625
  Vector mean: -0.0001
  Vector std: 0.4988
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 0.0000
  Vector mean: 0.0000
  Vector std: 0.0000
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.7188
  Vector mean: 0.0005
  Vector std: 0.2368
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.6562
  Vector mean: 0.0035
  Vector std: 0.4124
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.3594
  Vector mean: 0.0024
  Vector std: 0.3174
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.0703
  Vector mean: 0.0009
  Vector std: 0.1783
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.9531
  Vector mean: 0.0008
  Vector std: 0.1979
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.0156
  Vector mean: -0.0027
  Vector std: 0.4646
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.5625
  Vector mean: 0.0003
  Vector std: 0.2556
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.2344
  Vector mean: 0.0008
  Vector std: 0.3586
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.3906
  Vector mean: 0.0007
  Vector std: 0.2076
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 3.8691
  Vector mean: -0.0010
  Vector std: 0.0855
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 0.0000
  Vector mean: 0.0000
  Vector std: 0.0000
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.3828
  Vector mean: -0.0002
  Vector std: 0.1853
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.9258
  Vector mean: -0.0028
  Vector std: 0.1752
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 6.5625
  Vector mean: 0.0008
  Vector std: 0.1450
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.3047
  Vector mean: 0.0015
  Vector std: 0.2057
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.2188
  Vector mean: 0.0002
  Vector std: 0.4028
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 15.6875
  Vector mean: 0.0002
  Vector std: 0.3467
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.2422
  Vector mean: -0.0015
  Vector std: 0.1823
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 16.2188
  Vector mean: -0.0002
  Vector std: 0.3584
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.3906
  Vector mean: -0.0015
  Vector std: 0.2075
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.1250
  Vector mean: -0.0007
  Vector std: 0.2238
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.9688
  Vector mean: -0.0025
  Vector std: 0.2424
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.6328
  Vector mean: -0.0032
  Vector std: 0.2793
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.8750
  Vector mean: -0.0008
  Vector std: 0.1962
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.2188
  Vector mean: -0.0016
  Vector std: 0.2037
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.2422
  Vector mean: -0.0027
  Vector std: 0.2264
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 14.7344
  Vector mean: -0.0018
  Vector std: 0.3257
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.6406
  Vector mean: 0.0001
  Vector std: 0.1910
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.5312
  Vector mean: 0.0013
  Vector std: 0.2549
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 10.8906
  Vector mean: -0.0012
  Vector std: 0.2407
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 18.6406
  Vector mean: 0.0019
  Vector std: 0.4119
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 21.4375
  Vector mean: -0.0006
  Vector std: 0.4739
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 12.6875
  Vector mean: -0.0026
  Vector std: 0.2803
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 8.7500
  Vector mean: -0.0014
  Vector std: 0.1934
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.9531
  Vector mean: -0.0036
  Vector std: 0.2200
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 11.4609
  Vector mean: -0.0015
  Vector std: 0.2532
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.2031
  Vector mean: 0.0009
  Vector std: 0.2034
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 9.3750
  Vector mean: -0.0023
  Vector std: 0.2073
  Computing activation differences...
  Steering vector computed from 1 question(s)
  Vector shape: torch.Size([2048])
  Vector norm: 7.7305
  Vector mean: 0.0000
  Vector std: 0.1708

Layer 13 Results:
  Success Rate: 1.00%
  Average CAF: 0.009
Saved to outputs_tofu_3_KL/activation_steering_layer13.csv

============================================================
LAYER COMPARISON
============================================================
Layer      Success Rate    Average CAF    
------------------------------------------------------------
12         1.00%           0.008          
13         1.00%           0.009           ‚Üê BEST

Saved best layer results to outputs_tofu_3_KL/activation_steering_results.csv

--- Embedding Space Attack ---
